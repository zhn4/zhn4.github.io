---
title: 投票测试
date: 2016-10-16 16:01:40
tags:
---
### 投票测试
#### 投票系统
测试环境，自己模拟json数据
可扩展添加记分功能

```html
<h1>测试模板</h1>
<p>
  Q: <span id="question-box">???</span>
</p>
<ul id="answer-box">
  <!-- 模板 -->
  <!-- <li>
    <a href="javascript:;" class="answer">a1:</a>
  </li> -->
</ul>
<button id="sure">提交</button>

<style>
  /*答案默认样式*/
  .answer {
    color: blue;
  }
  /*答案选中样式*/
  .active {
    color: red;
    font-weight: bold;
  }
</style>
```

```javascript
var answer = document.getElementsByClassName('answer'),// 答案选项
    sure = document.getElementById('sure');// 确认按钮
    num = 0,
    judge_answer = false,// 是否选中答案
    chose = '',
    mark = 0;// 记录当前题目
    data = [
      {
        'q': '问题1',
        'a': [
          '答案1','答案2', '答案3', '答案4'
        ]
      },
      {
        'q': '问题2',
        'a': [
          '答案1', '答案2', '答案3', '答案4'
        ]
      },
      {
        'q': '问题3',
        'a': [
          '答案1', '答案2', '答案3', '答案4'
        ]
      },
      {
        'q': '问题4',
        'a': [
          '答案1', '答案2', '答案3', '答案4'
        ]
      }
    ]
    data_length = data.length,// 数据长度
    answer_box = document.getElementById('answer-box'),// 问题容器
    question_box = document.getElementById('question-box');// 答案容器

var add_answer = function(number) {// 添加问题
  answer_box.innerHTML = '';
  for(var i = 0; i < data[number].a.length; i++) {
    answer_box.insertAdjacentHTML('afterbegin', '<li><a href="javascript:;" class="answer">' + data[number].a[i] + '</a></li>')
  }
}

var add_question = function(number) {// 添加答案
  question_box.innerHTML = data[number].q;
}
// add_question(mark);

var add_fun = function(number) {// 调用问题/答案函数
  if(mark < data_length) {
    add_answer(number);
    add_question(number);
  }else {
    console.log('gg');
  }
}

add_fun(mark);

var click_fun = function() {
  for(var i = 0; i < answer.length; i++) {
    answer[i].num = i;
    answer[i].addEventListener('click', function() {// 选择答案
      answer[num].classList.remove('active');
      this.classList.add('active');
      chose = this.num;
      num = this.num;
      judge_answer = true;
    })
  }
}
click_fun();

sure.addEventListener('click', function() {// 确认提交
  if(judge_answer) {
    console.log('已经选择');
    console.log(answer[chose]); //显示已选择选项
    judge_answer = false;
    for(var i = 0; i < answer.length; i++) { //清空选择
      answer[i].classList.remove('active');
    }
    mark = mark + 1;// 题目数
    add_fun(mark);
    click_fun();
  }else {
    console.log('未选择');
  }
})
```
